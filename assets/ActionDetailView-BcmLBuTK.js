import{aE as x,as as W,r as T,d as _,b as c,o as r,h as v,i as p,u as t,aF as X,aG as Y,c as $,K as F,aH as q,aI as Z,aJ as ee,aK as te,aL as oe,f as O,F as B,j as I,v as A,t as R,aM as ne,aN as ae,aO as se,aP as re,g as J,M as j,w as S,aQ as le,aR as k,aS as C,aT as ie,aU as U,aw as ue,aV as de,I as ce}from"./vendor-B8zRC3vV.js";import{_ as H}from"./index-CJlODIm5.js";import"./charts-DAgbOmCx.js";let pe=0;function fe(){return`dndNode_${pe++}`}const ve={draggedType:T(null),isDragOver:T(!1),isDragging:T(!1)};function G(n,o){const{draggedType:e,isDragOver:a,isDragging:f}=ve,{addNodes:d,screenToFlowCoordinate:s,onNodesInitialized:m,updateNode:l}=x();W(f,i=>{document.body.style.userSelect=i?"none":""});function u(i,g){i.dataTransfer&&(i.dataTransfer.setData("application/vueflow",g),i.dataTransfer.effectAllowed="move"),e.value=g,f.value=!0,document.addEventListener("drop",z)}function y(i){i.preventDefault(),e.value&&(a.value=!0,i.dataTransfer&&(i.dataTransfer.dropEffect="move"))}function w(){a.value=!1}function z(){f.value=!1,a.value=!1,e.value=null,document.removeEventListener("drop",z)}function b(i){if(i.preventDefault(),!e.value)return;const[g,N]=e.value.split("-"),D=s({x:i.clientX,y:i.clientY}),h=fe(),M={id:h,type:g,position:D,data:{label:h,value:N??0,nodeType:N||"value"}},{off:P}=m(()=>{l(h,V=>({position:{x:V.position.x-(V.dimensions?.width||0)/2,y:V.position.y-(V.dimensions?.height||0)/2}})),P()});d(M),n?.value.push(M)}function E(i){n&&i&&(n.value=n.value.filter(g=>g.id!==i),o&&(o.value=o.value.filter(g=>g.source!==i&&g.target!==i)))}function L(i){n&&(n.value=i)}return{draggedType:e,isDragOver:a,isDragging:f,onDragStart:u,onDragLeave:w,onDragOver:y,onDrop:b,onDeleteNode:E,onResetNode:L}}function me(n){const{setViewport:o,toObject:e}=x();return{updatePos:()=>{n.value.forEach(s=>{s.position={x:Math.random()*400,y:Math.random()*400}})},logToObject:()=>{console.log(e())},resetViewport:s=>{s?s():o({x:0,y:0,zoom:1})}}}const ge={class:"dropzone-background"},_e={class:"overlay"},ye=_({__name:"DropzoneBackground",setup(n){return(o,e)=>(r(),c("div",ge,[v(t(X),{gap:12}),p("div",_e,[Y(o.$slots,"default",{},void 0,!0)])]))}}),we=H(ye,[["__scopeId","data-v-89ff1e3c"]]),he=_({__name:"FlowControls",setup(n){return(o,e)=>(r(),$(t(oe),{position:"top-right",class:"controls"},{default:F(()=>[p("div",{class:"control-btn",title:"Reset Transform",onClick:e[0]||(e[0]=a=>o.$emit("reset"))},[v(t(q))]),p("div",{class:"control-btn",title:"Shuffle Node Positions",onClick:e[1]||(e[1]=a=>o.$emit("shuffle"))},[v(t(Z))]),p("div",{class:"control-btn",title:"Log `toObject`",onClick:e[2]||(e[2]=a=>o.$emit("log"))},[v(t(ee))]),p("div",{class:"control-btn",title:"delete node",onClick:e[3]||(e[3]=a=>o.$emit("delete"))},[v(t(te))])]),_:1}))}}),De=H(he,[["__scopeId","data-v-fc10ed06"]]),$e={class:"nodes"},be=["onDragstart"],Ne=_({__name:"Sidebar",props:{nodeType:{}},setup(n){const o=n,{onDragStart:e}=G(),a=O(()=>o.nodeType==="math"?[{label:"Number Node",type:"value",class:"vue-flow__node-input"}]:[{label:"Input Node",type:"value-input",class:"vue-flow__node-input"},{label:"Default Node",type:"value-default",class:"vue-flow__node-default"},{label:"Output Node",type:"value-output",class:"vue-flow__node-output"}]);return(f,d)=>(r(),c("aside",null,[p("div",$e,[(r(!0),c(B,null,I(a.value,s=>(r(),c("div",{key:s.type,class:A(s.class),draggable:!0,onDragstart:m=>t(e)(m,s.type)},R(s.label),43,be))),128))])]))}}),ke=H(Ne,[["__scopeId","data-v-d59635ff"]]),Ce={key:0},K=_({__name:"FlowCanvas",props:{initialNodes:{},initialEdges:{},nodeTemplates:{},nodeType:{}},setup(n){const o=n,e=T(o.initialNodes||[]),a=T(o.initialEdges||[]),f=JSON.parse(JSON.stringify(o.initialNodes||[])),{updatePos:d,logToObject:s,resetViewport:m}=me(e),{onDragOver:l,onDrop:u,onDragLeave:y,isDragOver:w,onDeleteNode:z,onResetNode:b}=G(e,a),{onNodeClick:E}=x(),L=T();E(({node:N})=>{L.value=N.id});const{onConnect:i,addEdges:g}=x();return i(N=>g(N)),(N,D)=>(r(),c("div",{class:"flow-canvas",onDrop:D[2]||(D[2]=(...h)=>t(u)&&t(u)(...h))},[v(t(ae),{class:"basic-flow",nodes:e.value,edges:a.value,"default-viewport":{zoom:1,x:300,y:300},"fit-view-on-init":!1,"fit-view-on-update":!1,"min-zoom":.2,"max-zoom":4,onDragover:t(l),onDragleave:t(y)},ne({default:F(()=>[v(we,{style:j({backgroundColor:t(w)?"#e7f3ff":"transparent",transition:"background-color 0.2s ease"})},{default:F(()=>[t(w)?(r(),c("p",Ce,"Drop here")):S("",!0)]),_:1},8,["style"]),v(t(le)),v(De,{onReset:D[0]||(D[0]=h=>t(m)(t(b)(t(f)??[]))),onShuffle:t(d),onLog:t(s),onDelete:D[1]||(D[1]=h=>t(z)(L.value))},null,8,["onShuffle","onLog"])]),_:2},[I(o.nodeTemplates,(h,M)=>({name:M,fn:F(P=>[(r(),$(J(h),se(re(P)),null,16))])}))]),1032,["nodes","edges","onDragover","onDragleave"]),v(ke,{nodeType:o.nodeType},null,8,["nodeType"])],32))}}),xe=[{id:"1",position:{x:0,y:0},type:"value",data:{value:10}},{id:"2",position:{x:0,y:100},type:"value",data:{value:30}},{id:"3",position:{x:300,y:35},type:"operator",data:{operator:"+"}},{id:"4",position:{x:650,y:15},type:"result"}],Te=[{id:"e1-3",source:"1",target:"3",animated:!0,targetHandle:"target-a"},{id:"e2-3",source:"2",target:"3",animated:!0,targetHandle:"target-b"},{id:"e3-4",source:"3",target:"4",animated:!0}],Se={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Oe={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},ze={key:2,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Ee={key:3,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Le=_({__name:"Icon",props:["name"],setup(n){return(o,e)=>n.name==="+"?(r(),c("svg",Se,[...e[0]||(e[0]=[p("path",{fill:"currentColor",d:"M11 13H5v-2h6V5h2v6h6v2h-6v6h-2z"},null,-1)])])):n.name==="-"?(r(),c("svg",Oe,[...e[1]||(e[1]=[p("path",{fill:"currentColor",d:"M19 13H5v-2h14v2z"},null,-1)])])):n.name==="*"?(r(),c("svg",ze,[...e[2]||(e[2]=[p("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 12L6 6m6 6l6 6m-6-6l6-6m-6 6l-6 6"},null,-1)])])):n.name==="/"?(r(),c("svg",Ee,[...e[3]||(e[3]=[p("path",{fill:"currentColor",d:"M19 13H5v-2h14zm-7-8a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2m0 10a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2"},null,-1)])])):S("",!0)}}),Me={class:"buttons nodrag"},Ve=["onClick"],Fe=_({__name:"OperatorNode",props:["id","data"],setup(n){const o=n,e=["+","-","*","/"],{updateNodeData:a}=x();return(f,d)=>(r(),c("div",null,[p("div",Me,[(r(),c(B,null,I(e,s=>p("button",{key:`${n.id}-${s}-operator`,class:A({selected:n.data.operator===s}),onClick:m=>t(a)(o.id,{operator:s})},[v(Le,{name:s},null,8,["name"])],10,Ve)),64))]),v(t(C),{type:"source",position:t(k).Right,connectable:!1},null,8,["position"]),v(t(C),{id:"target-a",type:"target",position:t(k).Left},null,8,["position"]),v(t(C),{id:"target-b",type:"target",position:t(k).Left},null,8,["position"])]))}}),Re={class:"calculation"},Be={key:0},Ie=_({__name:"ResultNode",props:["id"],setup(n){const o={"+":(l,u)=>l+u,"-":(l,u)=>l-u,"*":(l,u)=>l*u,"/":(l,u)=>u!==0?l/u:0},{getConnectedEdges:e}=x(),a=ie({handleType:"target"}),f=O(()=>{const l=a.value[0];return l?.source?e(l.source).filter(u=>u.source!==l.source):[]}),d=U(()=>a.value.map(l=>l.source)),s=U(()=>f.value.map(l=>l.source)),m=O(()=>{const l=d.value.reduce((u,{data:y})=>{const w=y?.operator;return w?s.value.map(({data:b})=>b?.value??0).reduce((b,E)=>o[w]?.(b,E),0):u},0);return Math.round(l*100)/100});return(l,u)=>(r(),c("div",null,[p("div",Re,[(r(!0),c(B,null,I(t(s),(y,w)=>(r(),c(B,{key:`${y.id}-${y.data}`},[p("span",null,R(y.data?.value),1),w!==t(s).length-1?(r(),c("span",Be,R(t(d)[0]?.data?.operator),1)):S("",!0)],64))),128))]),u[0]||(u[0]=p("span",null," = ",-1)),p("span",{class:"result",style:j({color:m.value>0?"#5EC697":"#f15a16"})},R(m.value),5),v(t(C),{type:"target",position:t(k).Left,connectable:!1,style:j({background:m.value>0?"#5EC697":"#f15a16"})},null,8,["position","style"])]))}}),Pe=["id","type"],Q=_({__name:"ValueNode",props:{id:{},data:{},type:{}},setup(n){const o=n,{updateNodeData:e}=x(),a=O({get:()=>o.data.value,set:s=>e(o.id,{value:s})}),f={input:{top:!1,bottom:!0,right:!1,type:"text"},default:{top:!0,bottom:!0,right:!1,type:"text"},output:{top:!0,bottom:!1,right:!1,type:"text"},value:{top:!1,bottom:!1,right:!0,type:"number"}},d=O(()=>f[o.data.nodeType||"value"]);return(s,m)=>(r(),c("div",null,[ue(p("input",{id:`${n.id}-input`,"onUpdate:modelValue":m[0]||(m[0]=l=>a.value=l),type:d.value.type,class:"nodrag"},null,8,Pe),[[de,a.value]]),d.value.bottom?(r(),$(t(C),{key:0,type:"source",position:t(k).Bottom},null,8,["position"])):S("",!0),d.value.top?(r(),$(t(C),{key:1,type:"target",position:t(k).Top},null,8,["position"])):S("",!0),d.value.right?(r(),$(t(C),{key:2,type:"source",position:t(k).Right},null,8,["position"])):S("",!0)]))}}),je=_({__name:"FlowMath",setup(n){const o={"node-value":Q,"node-operator":Fe,"node-result":Ie};return(e,a)=>(r(),$(K,{"initial-nodes":t(xe),"initial-edges":t(Te),nodeType:"math","node-templates":o},null,8,["initial-nodes","initial-edges"]))}}),He=_({__name:"FlowWorker",setup(n){const o={"node-value":Q};return(e,a)=>(r(),$(K,{nodeType:"workflow","node-templates":o}))}}),Ge=_({__name:"ActionDetailView",setup(n){const o=ce(),e=[{id:1,component:je},{id:2,component:He}],a=O(()=>{const f=parseInt(o.params.id);return e.find(d=>d.id===f)?.component});return(f,d)=>(r(),$(J(a.value)))}});export{Ge as default};
//# sourceMappingURL=ActionDetailView-BcmLBuTK.js.map
