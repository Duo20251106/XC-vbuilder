{"version":3,"file":"DataSourceDetailView-FWirqg07.js","sources":["../../src/components/DataSourceContent/react_app/ReactDataSource.jsx","../../src/components/DataSourceContent/DataSourceContent.vue","../../src/views/DataSourceDetailView.vue"],"sourcesContent":["import '@glideapps/glide-data-grid/dist/index.css'\n\nimport { DataEditor, GridCellKind, GridColumnIcon } from '@glideapps/glide-data-grid'\nimport { useEffect, useMemo, useRef, useState } from 'react'\n\nconst tempDataPool = [\n    {\n        id: '001',\n        name: 'XC一',\n        age: '15',\n        isOpen: true,\n        hobby: ['music', 'dancing'],\n        avatar: ['https://i.pravatar.cc/300'],\n        notes: '**This is a markdown cell**'\n    },\n    {\n        id: '002',\n        name: 'XC二',\n        age: '18',\n        isOpen: true,\n        hobby: ['basketball', 'music'],\n        avatar: ['https://i.pravatar.cc/300'],\n        notes: 'true'\n    },\n    {\n        id: '003',\n        name: 'XC三',\n        age: '23',\n        isOpen: false,\n        hobby: ['dancing', 'basketball'],\n        avatar: ['https://i.pravatar.cc/300'],\n        notes: 'true'\n    },\n    {\n        id: '004',\n        name: 'XC四',\n        age: '25',\n        isOpen: true,\n        hobby: ['music', 'basketball'],\n        avatar: ['https://i.pravatar.cc/300'],\n        notes: 'true'\n    }\n]\n\nconst columns = [\n    { title: 'ID', width: 100, icon: GridColumnIcon.HeaderRowID },\n    { title: '姓名', width: 100, icon: GridColumnIcon.HeaderTextTemplate },\n    { title: '年龄', width: 100, icon: GridColumnIcon.HeaderNumber },\n    { title: '状态', width: 50 },\n    { title: '爱好', width: 200 },\n    { title: '头像', width: 200, icon: GridColumnIcon.HeaderImage },\n    { title: '笔记', width: 200, icon: GridColumnIcon.HeaderMarkdown }\n]\n\n// 组件函数\nexport default function ReactDataSource(props) {\n    const dsId = props.id // 判断数据量\n    const ref = useRef(null) // 获取dom容器\n\n    // 生成数据\n    const data = useMemo(() => {\n        const len = dsId === '1' ? 1000000 : \"dsId==='2\" ? 100000 : 10\n        const tempDataList = new Array(len).fill(0)\n        return tempDataList.map((item, index) => {\n            const randomIndex = Math.floor(Math.random() * 4)\n            const randomItem = tempDataPool[randomIndex]\n            const imgIndex = index % 71\n\n            return {\n                ...randomItem,\n                id: `00${index}`,\n                name: `XC${Math.random().toString(36).substring(2, 4)}`,\n                avatar: [`https://i.pravatar.cc/300?img=${imgIndex}`]\n            }\n        })\n    }, [dsId])\n\n    //获取单元格内容\n    const getData = ([col, row]) => {\n        const person = data[row]\n        switch (col) {\n            case 0:\n                return {\n                    kind: GridCellKind.RowID,\n                    data: person.id,\n                    allowOverlay: false,\n                    displayData: person.id\n                }\n            case 1:\n                return {\n                    kind: GridCellKind.Text,\n                    data: person.name,\n                    allowOverlay: true,\n                    displayData: person.name,\n                    hasMenu: true\n                }\n            case 2:\n                return {\n                    kind: GridCellKind.Number,\n                    data: person.age,\n                    allowOverlay: true,\n                    displayData: person.age\n                }\n            case 3:\n                return {\n                    kind: GridCellKind.Boolean,\n                    data: person.isOpen,\n                    displayData: person.isOpen\n                }\n            case 4:\n                return {\n                    kind: GridCellKind.Bubble,\n                    data: person.hobby,\n                    allowOverlay: true,\n                    displayData: person.hobby\n                }\n            case 5:\n                return {\n                    kind: GridCellKind.Image,\n                    data: person.avatar,\n                    allowOverlay: true,\n                    displayData: person.avatar\n                }\n            case 6:\n                return {\n                    kind: GridCellKind.Markdown,\n                    data: person.notes,\n                    allowOverlay: true,\n                    displayData: person.notes\n                }\n            default:\n                return {}\n        }\n    }\n\n    //动态计算表格尺寸\n    const [editorRect, setEditorRect] = useState({ width: 500, height: 300 })\n    const { width, height } = editorRect\n\n    useEffect(() => {\n        const calcRect = () => {\n            // 获取外部容器宽度\n            const outerContainerDom = ref.current.parentElement.parentElement\n            if (outerContainerDom) {\n                const { width, height } = outerContainerDom.getBoundingClientRect()\n                setEditorRect({ width: width - 12, height: height - 12 })\n            }\n        }\n\n        calcRect()\n        window.addEventListener('resize', calcRect, false)\n        return () => window.removeEventListener('resize', calcRect)\n    }, [])\n\n    return (\n        <div ref={ref}>\n            <DataEditor\n                key={dsId}\n                width={width}\n                height={height}\n                columns={columns}\n                getCellContent={getData}\n                rows={data.length}\n                onCellEdited={(p, q) => console.log(p, q)}\n            />\n            <div id=\"portal\" style={{ position: 'fixed', left: 0, top: 0, zIndex: 9999 }} />\n        </div>\n    )\n}\n","<script setup lang=\"ts\">\nimport { applyPureReactInVue } from 'veaury'\n\n// @ts-ignore\nimport ReactDataSource from './react_app/ReactDataSource'\nconst RDataSource = applyPureReactInVue(ReactDataSource)\n\ndefineProps<{\n    id: string\n}>()\n</script>\n<template>\n    <div class=\"data-source-content-wrapper\">\n        <div class=\"data-source-render\">\n            <r-dataSource :id=\"id\" />\n        </div>\n    </div>\n</template>\n\n<style scoped>\n.data-source-content-wrapper {\n    width: 100%;\n    background-color: var(--color-gray-100);\n}\n\n.data-source-render {\n    height: 100%;\n    background-color: var(--color-white);\n    border-radius: 8px;\n    overflow: hidden;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { useRoute } from 'vue-router'\n\nimport DataSourceContent from '@/components/DataSourceContent/DataSourceContent.vue'\nconst route = useRoute()\nconst dsId = computed(() => route.params.id as string)\n</script>\n\n<template>\n    <DataSourceContent :id=\"dsId\" />\n</template>\n\n<style scoped></style>\n"],"names":["tempDataPool","columns","GridColumnIcon","ReactDataSource","props","dsId","ref","useRef","data","useMemo","len","item","index","randomIndex","randomItem","imgIndex","getData","col","row","person","GridCellKind","editorRect","setEditorRect","useState","width","height","useEffect","calcRect","outerContainerDom","jsxs","jsx","DataEditor","p","q","RDataSource","applyPureReactInVue","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_unref","__props","route","useRoute","computed","_createBlock","DataSourceContent"],"mappings":"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"}